{% extends "info/header.html"%}

{% block content %}
  <div class="row-eq-height">
    <div class="col-sm-6 col-md-4">
      <div class="thumbnail">
          {% load staticfiles %}
          <img src="{% static '/img/question.jpg' %}" class="responsive-img" alt="img">

          <div class="caption">

            {% if current_day and not_answered %}
              {% include 'book/includes/responseform.html' %}

            {% elif not_answered %}
              <div class="panel-body">
                  <h4>{{ question.title }}</h4>
                </div>
                <div class="panel-footer">Вопрос закрыт, вы должны ответить на вопрос в течении недели</div>
              </div>

            {% else %}
              <div class="panel panel-default">
                <div class="panel-body">
                  <h4>{{ question.title }}</h4>
                </div>
                <div class="panel-footer">Вы уже ответили на этот вопрос</div>
              </div>

            {% endif %}
        </div>
      </div>
    </div>

  {% if question.response_set.all %}
    <div height = "490px" scroll ="auto"> 
      <div class="col-sm-6 col-md-6">
        <div class="thumbnail">

          {% include 'book/includes/messagecatcher.html' %}

          <div class="list-group-item active">
            Вы ответили:
          </div>

          <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            {% for response in paged_object %}              
              <div class="panel panel-default">
                <div class="panel-heading" role="tab" id="headingOne">
                  <h4 class="panel-title">
                    <a role="button" data-toggle="collapse" data-parent="#accordion" aria-expanded="false" aria-controls="{{ response.id }}" href="#{{ response.id }}" class="list-group-item">
                    <span class="label label-success">{{ response.date.year }}</span> {{ response.text }}</a>
                  </h4>
                </div>
                <div id="{{ response.id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                  <div class="panel-body">
                    <div class="panel panel-default">
                      <div class="panel-heading">Комментарии:</div>
                        <div class = "limit-height-200">                  
                          {% for comment in response.comment_set.all %}
                            <div class="panel-body"><span class="label label-success">
                            {{ comment.date.day }}.{{ comment.date.month }}.{{ comment.date.year }}</span> {{ comment.text }}</div>
                          {% endfor %}
                        </div>

                        <div class = "center low-margin">
                          <a class="btn btn-primary center" role="button" data-toggle="collapse" href="#collapseresponse{{ response.id }}" aria-expanded="false" aria-controls="collapseresponse{{ response.id }}">
                            Есть что добавить?
                          </a>
                          <div class="collapse" id="collapseresponse{{ response.id }}">
                            <div class="well">
                              {% include 'book/includes/commentform.html' %}
                            </div>
                          </div>
                        </div>

                    </div>
                  </div>
                </div>
              </div>
            {% endfor %}

          </div>

          {% include 'book/includes/listpagination.html' %}
        </div>
      </div>
    </div>
    </div>
  {% endif %}

<script>
function toggleResponseList(id) {
  var block = $('#show-comments-'+String(id));
  if (block.css("display", "none")) {
    block.css("display", "block");
  } else {
    block.css("display", "none");
  }
}
</script>
{% endblock %}